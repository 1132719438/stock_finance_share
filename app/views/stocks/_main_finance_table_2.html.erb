<!-- 1.所有的数据,都需要判断其数量,以便填充表格时能够确保样式和对应数据的准确性 -->

<div>
  <table class="table table-striped table-bordered">

    <tr class="theader-style">
      <% if time == 5 %>
        <td class="theader-style" width = "10%">类别</td>
        <td align=left width = "25%">财务比率</td>
        <% @stock.quarter_years[0..4].reverse.each do |i| %>
          <td align=center width = "13%"><%= i[0..3] %></td>
        <% end %>
      <% elsif time == 10 %>
        <td class="theader-style" width = "8%">类别</td>
        <td align=left width = "22%">财务比率</td>
        <% @stock.quarter_years[0..9].reverse.each do |i| %>
          <td align=center width = "7%"><%= i[0..3] %></td>
        <% end %>
      <% elsif time == 2 %>
        <td align=left width = "50%">财务比率</td>
        <% @stock.quarter_recent.reverse.each do |i| %>
          <td align=center width = "25%"><%= i %></td>
        <% end %>
      <% end %>
    </tr>

    <tr>
      <% if time != 2 %>
        <td class="theader-style" rowspan="2">财务结构</td>
      <% end %>
      <td align=left>负债占资产比率(%)</td>
      <% m = @stock.debt_asset_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.debt_asset_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>长期负债占不动产/厂房及设备比率(%)</td>
      <% m = @stock.long_term_funds_for_fixed_assets_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.long_term_funds_for_fixed_assets_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <% if time != 2 %>
        <td class="theader-style" rowspan="2">偿债能力</td>
      <% end %>
      <td align=left>流动比率(%)</td>
      <% m = @stock.current_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.current_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>速动比率(%)</td>
      <% m = @stock.quick_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.quick_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <% if time != 2 %>
        <td class="theader-style" rowspan="6">经营能力</td>
      <% end %>
      <td align=left>应收账款周转率(次)</td>
      <% m = @stock.accounts_receivable_turnover_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.accounts_receivable_turnover_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>平均收现日数</td>
      <% m = @stock.accounts_receivable_turnover_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.accounts_receivable_turnover_ratio(time).reverse.each do |i| %>
        <td><%= (360 / i).round(2) %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>存货周转率(次)</td>
      <% m = @stock.inventory_turnover_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.inventory_turnover_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>平均销货日数(平均在库天数)</td>
      <% m = @stock.inventory_turnover_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.inventory_turnover_ratio(time).reverse.each do |i| %>
        <td><%= (360 / i).round(2) %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>不动产/厂房及设备周转率(次)</td>
      <% m = @stock.fixed_asset_turnover_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.fixed_asset_turnover_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>总资产周转率(次)</td>
      <% m = @stock.total_asset_turnover_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.total_asset_turnover_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <% if time != 2 %>
        <td class="theader-style" rowspan="7">获利能力</td>
      <% end %>
      <td align=left>股东权益报酬率(%) RoE</td>
      <% m = @stock.roe_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.roe_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>营业毛利率(%) ①</td>
      <% m = @stock.operating_margin_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.operating_margin_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>营业利益率(%) ②</td>
      <% m = @stock.business_profitability_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.business_profitability_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>经营安全边际率(%) = ② / ①</td>
      <% m = @stock.operating_margin_of_safety_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.operating_margin_of_safety_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>纯益率(%) = 净利率</td>
      <% m = @stock.net_profit_margin_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.net_profit_margin_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>每股盈余(元)</td>
      <% m = @stock.earnings_per_share(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.earnings_per_share(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>税后净利(百万元)</td>
      <% m = @stock.after_tax_profit(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.after_tax_profit(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <% if time != 2 %>
        <td class="theader-style" rowspan="3">现金流量</td>
      <% end %>
      <td align=left>现金流量比率(%)</td>
      <% m = @stock.operating_cash_flow_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.operating_cash_flow_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>现金流量允当比率(%)</td>
      <% m = @stock.cash_flow_adequancy_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.cash_flow_adequancy_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

    <tr>
      <td align=left>现金再投资比率(%)</td>
      <% m = @stock.cash_re_investment_ratio(time).reverse.size %>
      <% (1..time - m).each do |i| %>
        <td align=center>无统计</td>
      <% end %>
      <% @stock.cash_re_investment_ratio(time).reverse.each do |i| %>
        <td><%= i %></td>
      <% end %>
    </tr>

  </table>
</div>
